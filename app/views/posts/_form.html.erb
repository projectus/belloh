

<%= form_for(@post) do |f| %>
  <%= render 'errors' %>

	<div class="row-fluid subject-line">



      [ <%= f.text_field :sender_desc %> ]

	    @


      [ <%= f.text_field :receiver_desc %> ]

  </div>
	<div class="row-fluid">

      Message:

      <select>
        <option>Neutral</option>
        <option>Good</option>
        <option>Bad</option>
        <option>Caution</option>

      </select>


      <%= f.text_area :content, class: 'input-xxlarge' %>

  </div>
  <div>
    <%= f.submit 'Post' %>
  </div>
  <div>
    <%= hidden_field_tag "post[longitude]" %>
    <%= hidden_field_tag "post[latitude]" %>
  </div>
<% end %>

<script>
// Javascript to fetch user's location upon submitting the form

	$(function() {
	  $('#new_post').submit(function() {
			if (lon.value && lat.value)
			  return true;
	    getLocation(setPosition);
	    return false; // return false to cancel form action
	  });

	  $('#cancel').on('click',function(){alert('ok');})
	});

	var lon=document.getElementById("post_longitude");
	var lat=document.getElementById("post_latitude");

	function setPosition(position) {
    lat.value=position.coords.latitude;
	  lon.value=position.coords.longitude;
    $('#new_post').submit(); // submit
	}

	function hideForm() {
		$('#new_post_box').hide();
		$('#new_post_link').show();
	}
</script>

