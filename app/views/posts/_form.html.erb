<%= form_for(post) do |f| %>
  <%= render partial: 'posts/errors', locals: {post: post} %>

	<div id="new_post_header">
    [ <%= f.text_field :sender_desc, placeholder: 'Sender description' %> ]
    @
    [ <%= f.text_field :receiver_desc, placeholder: 'Receiver description' %> ]
  </div>

  <div class="input-prepend input-append">
	  <span class="add-on">
	    <ul class="nav">
	      <li class="dropdown">
	        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
	          <%= image_tag 'tiles/hippo.png', style: 'width:40px;' %>
	          <div class="triangle-bottomright"></div>
	        </a>
	        <ul class="dropdown-menu">
	          <li class="row-fluid">
	            <ul class="unstyled span6">
	              <li mood="neutral" class="mood-option"><%= image_tag 'tiles/hippo.png' %></li>
	              <li mood="positive" class="mood-option"><%= image_tag 'tiles/hippo.png' %></li>
	            </ul>
	            <ul class="unstyled span6">
	              <li mood="caution" class="mood-option"><%= image_tag 'tiles/hippo.png' %></li>
	              <li mood="negative" class="mood-option"><%= image_tag 'tiles/hippo.png' %></li>
	            </ul>
	          </li>
	        </ul>
	      </li>
	    </ul>
	  </span>
    <%= f.text_area :content, placeholder: 'Message' %>
    <%= f.submit 'Belloh', class: 'btn btn-info' %>
  </div>

	<%= f.hidden_field :mood, id: 'mood' %>

  <% if post.class == Post %>
    <%= f.hidden_field :latitude %>
    <%= f.hidden_field :longitude %>
  <% else %>
    <%= f.hidden_field :virtual_hub_id %>
  <% end %>
<% end %>

<script>
$(function(){
    $('.mood-option').click(function(){
	    var mood = $(this).attr('mood');
	    $('#new_post_box').attr('mood',mood);
	    $("#mood").val(mood);
    });

    $('.input-prepend').each(function(){
        var $textarea = $(this).find('textarea');
        var $span = $(this).find('span.add-on');
        var $submit = $(this).find('input[type=submit]');
        var ta_height = $textarea.outerHeight();

        var span_height = parseInt($span.css('padding-top'))+
				parseInt($span.css('padding-bottom'))+
				parseInt($span.css('margin-top'))+
				parseInt($span.css('margin-bottom'));

        var submit_height = parseInt($submit.css('padding-top'))+
				parseInt($submit.css('padding-bottom'))+
				parseInt($submit.css('margin-top'))+
				parseInt($submit.css('margin-bottom'));
					  
        $span.height(ta_height-span_height);
        $submit.height(ta_height-submit_height-2);
    });

	  $('.mood-option').bind("mouseover", function(){
	    $(this).css("opacity", "1");
	  }).bind("mouseout", function(){
	    $(this).css("opacity", "0.7");
	  });
});
</script>
